{% extends "userspace/library/base.html" %}
{% load i18n %}
{% load rules %}


{% block title %}{% trans "Adresses IP" %} {{ block.super }}{% endblock title %}

{% block breadcrumb %}{{ block.super }}
<li><a href="{% url 'userspace:library:subscription_ips:list' organisation_pk=scope_current_organisation.pk %}">{% trans "Adresses IP" %}</a></li>
{% endblock breadcrumb %}

{% block section_title %}
{% trans "Adresses IP" %}
{% endblock %}

{% block section_intro %}
{% blocktrans %}
<p>Vous trouverez ci-dessous les plages d’adresses IP actuellement enregistrées pour votre établissement et qui permettent à vos usagers d’accéder aux revues souscrites.</p>
{% endblocktrans %}
{% endblock section_intro %}

{% block section_aside %}
{% blocktrans with organisation=scope_current_organisation.name %}
<p>Pour nous faire part de changements dans ces adresses IP, merci de communiquer avec nous à <a href="mailto:client@erudit.org?subject=Changement%20d’adresses%20IP%20–%20{{ organisation }}">client@erudit.org</a>.</p>
{% endblocktrans %}
{% endblock %}

{% block content_main %}
{% has_perm 'has_staff_access' request.user as has_staff_access %}
{% if has_active_subscription %}
<div class="row">
  <div class="col-md-8">
    <h2>{% trans "Plages d’adresses actives" %}</h2>
  </div>
  <div class="col-md-4 text-right">
    {% if has_staff_access %}
    <a href="{% url 'userspace:library:subscription_ips:create' organisation_pk=scope_current_organisation.pk %}" class="btn btn-primary"><span class="ion-plus"></span>&nbsp;{% trans "Ajouter" %}</a>
    {% endif %}
  </div>
</div>

{% include "userspace/partials/pagination.html" %}
<div class="table">
  <ul class="table-header">
    <li class="row">
      <span class="col-sm-3">{% trans "Titre" %}</span>
      <span class="col-sm-3">{% trans "Début" %}</span>
      <span class="col-sm-3">{% trans "Fin" %}</span>
      <span class="col-sm-3">{% trans "Supprimer" %}</span>
    </li>
  </ul>

  <ul class="table-body">
    {% for ip_range in subscription_ip_ranges %}
    <li class="table-row-wrapper">
      <div class="row table-row">
        <span class="col-sm-3">{{ ip_range.subscription }}</span>
        <span class="col-sm-3">{{ ip_range.ip_start }}</span>
        <span class="col-sm-3">{{ ip_range.ip_end }}</span>
        <span class="col-sm-3">
          {% if has_staff_access %}
          <a href="{% url 'userspace:library:subscription_ips:delete' organisation_pk=scope_current_organisation.pk pk=ip_range.pk %}" title="{% trans 'Supprimer cette plage d’adresses IP' %}">
            <span class="ion-ios-close table-row-delete"></span>
          </a>
          {% endif %}
        </span>
      </div>
    </li>
    {% endfor %}
  </ul>
</div>
{% else %}
<marquee>Ne pas afficher les adresses IP</marquee>
{% endif %}
{% include "userspace/partials/pagination.html" %}
{% endblock content_main %}
