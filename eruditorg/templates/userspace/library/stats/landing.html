{% extends "userspace/library/base.html" %}
{% load i18n %}

{% block title %}{% trans "Consultations" %} {{ block.super }}{% endblock title %}

{% block breadcrumb %}{{ block.super }}
<li xmlns="http://www.w3.org/1999/html"><a href="{% url 'userspace:library:stats:landing' organisation_pk=scope_current_organisation.pk %}">{% trans "Consultations" %}</a></li>
{% endblock breadcrumb %}

{% block section_title %}
{% trans "Consultations" %}
{% endblock %}

{% block section_intro %}
{% blocktrans %}
<p>Cette section vous donne accès aux statistiques de consultation de votre établissement pour les différentes revues souscrites. Les rapports disponibles respectent la norme COUNTER (R4), et nous mettons à votre disposition les rapports JR1 et JR1 GOA, aux formats CSV, XML ou HTML, par année d’abonnement ou pour la période de votre choix.</p>
{% endblocktrans %}
{% endblock section_intro %}

{% block section_aside %}
{% blocktrans %}
<p>Notez que les revues du fonds <strong>Centre for Digital Scholarship</strong> ne sont pas incluses dans ces rapports, car elles ne sont pas hébergées sur nos serveurs&nbsp;; il nous est impossible de compiler ces statistiques de consultation.</p>
<p>Consultez <a href="https://www.erudit.org/fr/revues/?collections=unb" target="_blank" title="Voir la liste des revues Centre for Digital Scholarship">la liste des titres concernés ici</a>.</p>
{% endblocktrans %}
{% endblock %}

{% block content_main %}
{% if last_valid_subscription %}
<div>

  <ul class="nav-tabs" role="tablist">
    <li role="presentation" class="active"><a href="#jr1" aria-controls="jr1" role="tab" data-toggle="tab">{% trans "JR1" %}</a></li>
    <li role="presentation"><a href="#jr1-goa" aria-controls="jr1-goa" role="tab" data-toggle="tab">{% trans "JR1 GOA" %}</a></li>
  </ul>

  <div class="tab-content">
    <section role="tabpanel" class="tab-pane active" id="jr1">
      <h2>{% trans "COUNTER" %} <br> {% trans "Journal Report 1 (R4)" %}</h2>
      <div class="row">
        <div class="col-md-7">
          <p>{% trans "Nombre de requêtes réussies d’articles en texte intégral par mois et par revue" %}</p>
        </div>
      </div>
      {% for error in counter_jr1_form.errors.values %}
      {{ error }}
      {% endfor %}
      <form method="get">
        {{ counter_jr1_form.report_type }}

        <fieldset>
          <legend>
            <h3>{% trans "Période" %}</h3>
          </legend>

          <div class="row form-group">
            <div class="col-xs-6 col-md-4">
              <label for="{{ counter_jr1_form.year.auto_id }}">{% trans "Par année" %}</label>
              {{ counter_jr1_form.year }}
            </div>
          </div>

          <div class="separator"><strong>{% trans "ou" %}</strong></div>

          <div class="row form-group">
            <div class="col-sm-3 col-md-4">
              <h4>{% trans "Début" %}</h4>
            </div>
            <div class="col-sm-9 col-md-8">
              <div class="row">
                <div class="col-xs-6">
                  <label for="{{ counter_jr1_form.month_start.auto_id }}">{% trans "Mois" %}</label>
                  {{ counter_jr1_form.month_start }}
                </div>
                <div class="col-xs-6">
                  <label for="{{ counter_jr1_form.year_start.auto_id }}">{% trans "Année" %}</label>
                  {{ counter_jr1_form.year_start }}
                </div>
              </div>
            </div>
          </div>

          <div class="row form-group">
            <div class="col-sm-3 col-md-4">
              <h4>{% trans "Fin" %}</h4>
            </div>
            <div class="col-sm-9 col-md-8">
              <div class="row">
                <div class="col-xs-6">
                  <label for="{{ counter_jr1_form.month_end.auto_id }}">{% trans "Mois" %}</label>
                  {{ counter_jr1_form.month_end }}
                </div>
                <div class="col-xs-6">
                  <label for="{{ counter_jr1_form.year_end.auto_id }}">{% trans "Année" %}</label>
                  {{ counter_jr1_form.year_end }}
                </div>
              </div>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>
            <h3>{% trans "Format" %}</h3>
          </legend>
          <div class="row form-group">
            <div class="col-xs-6 col-md-4">
              <label for="{{ counter_jr1_form.format.auto_id }}">{% trans "Format des données" %}</label>
              {{ counter_jr1_form.format }}
            </div>
          </div>
        </fieldset>

        <button id="submit-id-submit" class="btn btn-primary" name="submit" type="submit">{% trans 'Télécharger' %}</button>
      </form>

    </section>

    <section role="tabpanel" class="tab-pane" id="jr1-goa">
      <h2>{% trans "COUNTER" %} <br> {% trans "Journal Report 1 GOA (R4)" %}</h2>
      <div class="row">
        <div class="col-md-7">
          <p>{% trans "Nombre de requêtes réussies d’articles en libre accès en texte intégral par mois et par revue" %}</p>
        </div>
      </div>

      {% for error in counter_jr1goa_form.errors.values %}
      {{ error }}
      {% endfor %}
      <form method="get">
        {{ counter_jr1goa_form.report_type }}

        <fieldset>
          <legend>
            <h3>{% trans "Période" %}</h3>
          </legend>

          <div class="row form-group">
            <div class="col-xs-6 col-md-4">
              <label for="{{ counter_jr1goa_form.year.auto_id }}">{% trans "Par année" %}</label>
              {{ counter_jr1goa_form.year }}
            </div>
          </div>

          <div class="separator"><strong>{% trans "ou" %}</strong></div>

          <div class="row form-group">
            <div class="col-sm-3 col-md-4">
              <h4>{% trans "Début" %}</h4>
            </div>
            <div class="col-sm-9 col-md-8">
              <div class="row">
                <div class="col-xs-6">
                  <label for="{{ counter_jr1goa_form.month_start.auto_id }}">{% trans "Mois" %}</label>
                  {{ counter_jr1goa_form.month_start }}
                </div>
                <div class="col-xs-6">
                  <label for="{{ counter_jr1goa_form.year_start.auto_id }}">{% trans "Année" %}</label>
                  {{ counter_jr1goa_form.year_start }}
                </div>
              </div>
            </div>
          </div>

          <div class="row form-group">
            <div class="col-sm-3 col-md-4">
              <h4>{% trans "Fin" %}</h4>
            </div>
            <div class="col-sm-9 col-md-8">
              <div class="row">
                <div class="col-xs-6">
                  <label for="{{ counter_jr1goa_form.month_end.auto_id }}">{% trans "Mois" %}</label>
                  {{ counter_jr1goa_form.month_end }}
                </div>
                <div class="col-xs-6">
                  <label for="{{ counter_jr1goa_form.year_end.auto_id }}">{% trans "Année" %}</label>
                  {{ counter_jr1goa_form.year_end }}
                </div>
              </div>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>
            <h3>{% trans "Format" %}</h3>
          </legend>
          <div class="row form-group">
            <div class="col-xs-6 col-md-4">
              <label for="{{ counter_jr1goa_form.format.auto_id }}">{% trans "Format des données" %}</label>
              {{ counter_jr1goa_form.format }}
            </div>
          </div>
        </fieldset>

        <button id="submit-id-submit" class="btn btn-primary" name="submit" type="submit">{% trans 'Télécharger' %}</button>
      </form>
    </section>
  </div>

</div>
{% else %}
<section>
  <div class="glory">
    {% blocktrans %}Vous n'avez jamais été abonné à la plateforme érudit{% endblocktrans %}
  </div>
</section>
{% endif %}

{% endblock content_main %}
