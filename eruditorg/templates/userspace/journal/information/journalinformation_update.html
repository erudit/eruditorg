{% extends "userspace/journal/base.html" %}
{% load i18n widget_tweaks waffle_tags %}
{% block data_controller %}userspace:journalinformation:update{% endblock %}
{% block title %}{% trans "À propos" %} {{ block.super }}{% endblock title %}

{% block extrahead %}
  {{ form.media.css }}
{% endblock extrahead %}

{% block breadcrumb %}{{ block.super }}
<li><a href="{% url 'userspace:journal:information:update' journal_pk=scope_current_journal.pk %}">{% trans "À propos" %}</a></li>
{% endblock breadcrumb %}

{% block section_title %}
{% trans "À propos de la revue" %}
{% endblock %}

{% block section_intro %}
{% blocktrans %}
<p>La page <em>À propos</em> est la vitrine de votre revue sur Érudit&nbsp;: c’est ici que vous pourrez présenter votre publication, sa ligne éditoriale, son équipe, bref, tous les éléments que vous considérez importants. Il est ainsi recommandé de rédiger du contenu pour chacune des sections, tant en français qu’en anglais.</p>
<p>Cette page sera consultée par des lecteurs qui souhaiteront mieux connaître votre revue, mais aussi par de potentiels auteurs, des agrégateurs et des bibliothécaires.</p>
{% endblocktrans %}
{% endblock section_intro %}

{% block content_main %}

<form  class="form-vertical"
       method="post"
       action="{% url 'userspace:journal:information:update' journal_pk=scope_current_journal.pk %}?lang={{ selected_language }}">{% csrf_token %}
  {% if form.non_field_errors %}
  {% for error in form.non_field_errors %}
  <p class="alert">{{ error }}</p>
  {% endfor %}
  {% endif %}


  <h2>{% trans "Coordonnées générales" %}</h2>
  {% with field_template="userspace/journal/information/partials/info_single_field.html" %}
  <fieldset>
    <div class="row">
      <p class="col-sm-9">
        {% trans "Les coordonnées de la revue seront affichées sur le site pour orienter les usagers concernant certaines demandes, notamment les abonnements individuels." %}
      </p>
      {% include field_template with field=form.organisation_name only %}
      {% include field_template with field=form.phone type="tel" autocomplete="tel" only %}
      {% include field_template with field=form.email type="email" autocomplete="email" only %}
      {% include field_template with field=form.subscription_email type="email" autocomplete="email" only %}
    </div>
    <hr/>
  </fieldset>

  <fieldset>
    <legend>{% trans "Gestion de la revue" %}</legend>
    <div class="row">
      <p class="col-sm-9">
        {% blocktrans %}
        Saisissez ici les informations liées à l’administration, l’aspect légal et le processus de publication de votre revue.
        {% endblocktrans %}
      </p>
      {% include field_template with select_field=form.peer_review_process only %}
      {% include field_template with select_field=form.languages only %}
      {% include field_template with field=form.frequency default_value="" only %}
    </div>
    <hr/>
  </fieldset>

  <fieldset>
    <legend>{% trans "Liens" %}</legend>
    <div class="row">
      <p class="col-sm-9">
        {% blocktrans %}
        Les informations saisies seront disponibles publiquement, dans la page <em>À propos</em> de cette revue, à la sauvegarde de ce formulaire.
        {% endblocktrans %}
      </p>
      {% include field_template with field=form.facebook_url type="url" autocomplete="url" icon="ion-social-facebook" only %}
      {% include field_template with field=form.twitter_url type="url" autocomplete="url" icon="ion-social-twitter" only %}
      {% include field_template with field=form.website_url type="url" autocomplete="url" icon="ion-ios-world-outline" only %}
    </div>
  </fieldset>
  {% endwith %}

  <div class="text-right">
    <button id="submit-id-submit" class="btn btn-primary" name="submit" type="submit">{% trans 'Sauvegarder' %}</button>
  </div>

  <ul class="tabs">
    {% for langcode, langname in LANGUAGES %}
    <li class="tabs__item{% if langcode == selected_language %} tabs__item_active{% endif %}">
      <a href="{% url 'userspace:journal:information:update' journal_pk=scope_current_journal.pk %}?lang={{ langcode }}">{{ langname }}</a>
    </li>
    {% endfor %}
  </ul>

  {% for field in form.get_textbox_fields %}
  <fieldset id="div_id_{{ field.html_name }}"{% if field.errors %} class="has-error"{% endif %}>
    <h2><label class="control-label" for="{{ field.auto_id }}">{{ field.label }}</label></h2>
    {% if field.help_text %}
    <div class="row">
      <p class="col-md-10">{{ field.help_text }}</p>
    </div>
    {% endif %}
    {{ field|add_class:'form-control' }}
    {% for error in field.errors %}<p class="error">{{ error }}</p>{% endfor %}
  </fieldset>
  {% if not forloop.last %}<hr>{% endif %}
  {% endfor %}
  <div class="text-right">
    <button id="submit-id-submit" class="btn btn-primary" name="submit" type="submit">{% trans 'Sauvegarder' %}</button>
  </div>
</form>
{% endblock content_main %}

{% block footerscript %}
  {{ form.media.js }}
{% endblock footerscript %}
