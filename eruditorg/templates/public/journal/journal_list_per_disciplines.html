{% extends "public/base.html" %}
{% load i18n %}
{% load static %}
{% load cache %}

{% block page_title %}{% trans "Revues" %}{% endblock page_title %}

{% block structured_data %}
{{ block.super }}
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item": {
      "@id": "{{ request.scheme }}://{{ request.site.domain }}",
      "name": "Érudit"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item": {
      "@id": "{{ request.scheme }}://{{ request.site.domain }}{% url 'public:journal:journal_list' %}",
      "name": "{% trans 'Revues' %}"
    }
  }]
}
</script>
{% endblock structured_data %}

{% block body_class %}{{ block.super }} journal_list_per_disciplines{% endblock %}
{% block data_controller %}public:journal:journal_list{% endblock data_controller %}

{% block breadcrumb %}{{ block.super }}
  / <a href="{% url 'public:journal:journal_list' %}">{% trans "Revues" %}</a>
{% endblock %}

{% block content %}
<div id="journal_list_per_disciplines">
  <header class="page-header-main sorting-index container-fluid">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 clearfix">
            <h1 class="h3 bold pull-left">{% if sorting == 'name' %}{% trans "Revues par ordre alphabétique" %}{% elif sorting == 'disciplines' %}{% trans "Revues par disciplines" %}{% endif %}</h1>
            <nav class="pull-right">
              <a href="{% url 'public:journal:journal_list' %}?sorting=name" class="btn btn-primary-outlined pull-right">{% trans "Revues par ordre alphabétique" %}</a>
            </nav>
          </div>
        </div>
        <div class="row">
          <nav class="col-xs-12 index">
            <ul>
              {% for objects_group in sorted_objects %}
                {% if not objects_group.key %}
                  <li><a href="#section-void">{% trans "Autres" %}</a></li>
                {% else %}
                  <li><a href="#section-{{ objects_group.key }}">{{ objects_group.name }}</a></li>
                {% endif %}
              {% endfor %}
            <ul>
          </nav>
        </div>
      </div>
  </header>

  {% cache FOREVER_TTL "public_journal_list_disciplines" LANGUAGE_CODE %}
  {% for objects_group in sorted_objects %}
  <a name="{% if not objects_group.key %}section-void{% else %}section-{{ objects_group.key }}{% endif %}" class="invisible">{{ discipline }}</a>
  <section class="sorting-group container-fluid {% cycle "odd" "even" %}">
    <header class="row sorting-group--title">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 title">
            <h2>
              {% if not objects_group.key %}
                {% trans "Autres" %}
              {% else %}
                {{ objects_group.name }}
              {% endif %}
              <a href="#top" class="erudicon erudicon-arrow-up scroll-top"></a>
            </h2>
          </div>
        </div>
      </div>
    </header>
    {% for collection_group in objects_group.collections %}
    <section class="container sorting-group--articles sorting-group--articles--default">
      <ul class="row sorting-group--journals">
        <li class="col-sm-6 col-md-3 collection-title">
          <h3 {% if collection_group.key.code == "erudit" %}class="collection-erudit"{% endif %}>{{ collection_group.key.name }}</h3>
        </li>
        {% for journal in collection_group.objects %}
        <li class="col-sm-6 col-md-3 journal-item">
          <a
          {% if journal.external_url %}
          href="{% url 'public:journal:journal_external_redirect' journal.localidentifier %}"
          target="_blank"
          {% else %}
          href="{% url 'public:journal:journal_detail' journal.code %}"
          {% endif %}>
            <div class="journal-title">
              <span>{{ journal.name }}</span>
              {% if journal.subtitle %}
              <span><br/>{{ journal.subtitle }}</span>
              {% endif %}
            </div>
            {% if journal.provided_by_fedora %}
            <div class="row">
              <div class="col-xs-4 pull-right">
                <img src="{% url 'public:journal:journal_logo' journal.code %}" alt="{{ journal.name }}" class="img-responsive" />
              </div>
            </div>
            {% endif %}
          </a>
        </li>
        {% endfor %}
      </ul>
    </section>
    {% endfor %}
  </section>
  {% endfor %}
  {% endcache %}

</div>
{% endblock %}
