{% load i18n %}

<div id="id_cite_modal_{{ article.id }}" class="modal cite-modal col-lg-4 col-md-5 col-sm-6 col-xs-12 col-centered">
  <h2 class="modal-header">{% trans "Outils de citation" %}</h2>
  <div class="modal-body">
    <h3>{% trans "Citer cet article" %}</h3>
    <dl class="cite-modal--style-list">
      <dt>MLA</dt>
      <dd id="id_cite_mla_{{ article.id }}" class="cite-mla">
        {% if article.erudit_object.authors|length == 2 %}
          {% for author in article.erudit_object.authors %}
            {% if author.firstname and author.lastname %}
              {% if forloop.first %}
              {{ author.lastname }}, {{ author.firstname }} {% trans 'et' %}
              {% else %}
              {{ author.firstname }} {{ author.lastname }}.
              {% endif %}
            {% elif author.othername %}
              {{ author.othername }} {% if forloop.first %}{% trans 'et' %}{% endif %}
            {% endif %}
          {% endfor %}
        {% elif article.erudit_object.authors|length > 1 %}
          {% with article.erudit_object.authors|first as author %}
          {{ author.lastname }}, {{ author.firstname }}, et al.
          {% endwith %}
        {% else %}
          {% for author in article.erudit_object.authors %}
            {% if author.firstname and author.lastname %}
              {{ author.lastname }}, {{ author.firstname }}.
            {% elif author.othername %}
              {{ author.othername }}.
            {% endif %}
          {% endfor %}
        {% endif %}
        {% trans '«&nbsp;' %}{{ article.title }}.{% trans '&nbsp;»' %}
        <em>{{ article.issue.journal.name }}</em>,
        {{ article.issue.volume_title|lower }}, {% trans 'p.' %}&nbsp;{{ article.first_page }}–{{ article.last_page }}. {% if article.doi %}doi:{{ article.doi }}{% endif %}
      </dd>

      <dt>APA</dt>
      <dd id="id_cite_apa_{{ article.id }}" class="cite-apa">
        {% for author in article.erudit_object.authors %}
          {% if author.firstname and author.lastname %}
            {{ author.lastname }}, {{ author.firstname|slice:"1" }}.{% if forloop.revcounter == 2 %} & {% elif not forloop.last %}, {% endif %}
          {% elif author.othername %}{% if forloop.revcounter == 2 %} & {% else %}, {% endif %}
            {{ author.othername }}.
          {% endif %}
        {% endfor %}
        ({{ article.issue.year }}).
        {{ article.title }}.
        <em>{{ article.issue.journal.name }}</em>,
        {% if article.issue.volume %}<em>{{ article.issue.volume }}</em>{% endif %}{% if article.issue.number %}({{ article.issue.number }}){% endif %},
        {{ article.first_page }}–{{ article.last_page }}. {% if article.doi %}doi:{{ article.doi }}{% endif %}
      </dd>

      <dt>Chicago</dt>
      <dd id="id_cite_chicago_{{ article.id }}" class="cite-chicago">
        {% for author in article.erudit_object.authors %}
          {% if author.firstname and author.lastname %}
            {% if article.erudit_object.authors|length == 1 %}
              {{ author.lastname }}, {{ author.firstname }}.
            {% elif forloop.counter == 1 %}
              {{ author.lastname }}, {{ author.firstname }},
            {% else %}
              {{ author.firstname }} {{ author.lastname }}{% if forloop.revcounter == 2 %} {% trans 'et' %} {% elif not forloop.last %}, {% else %}.{% endif %}
            {% endif %}
          {% elif author.othername %}
            {{ author.othername }}{% if forloop.revcounter == 2 %} {% trans 'et' %} {% elif not forloop.last %}, {% else %}.{% endif %}
          {% endif %}
        {% endfor %}
        {% trans '«&nbsp;' %}{{ article.title }}{% trans '&nbsp;»' %}. 
        <em>{{ article.issue.journal.name }}</em>
        {% if article.issue.volume %}{{ article.issue.volume }}, {% endif %}{% if article.issue.number %}{% trans 'n<sup>o</sup>' %} {{ article.issue.number }}{% endif %}
        ({{ article.issue.year }}){% trans '&nbsp;:' %} {{ article.first_page }}–{{ article.last_page }}. {% if article.doi %}doi:{{ article.doi }}{% endif %}
      </dd>
    </dl>

    <hr />
    <h3>{% trans "Exporter la notice de ce document" %}</h3>
    <p>
      <a href="{% url 'public:journal:article_citation_enw' journal_code=article.issue.journal.code issue_slug=article.issue.volume_slug issue_localid=article.issue.localidentifier localid=article.localidentifier %}" class="btn btn-primary cite-export">
        <span class="show cite-export-title">.ENW</span>
      </a>
      EndNote, Zotero
    </p>
    <p>
      <a href="{% url 'public:journal:article_citation_ris' journal_code=article.issue.journal.code issue_slug=article.issue.volume_slug issue_localid=article.issue.localidentifier localid=article.localidentifier %}" class="btn btn-primary cite-export">
        <span class="show cite-export-title">.RIS</span>
      </a>
      Papers, Reference Manager, RefWorks, Zotero
    </p>
    <p>
      <a href="{% url 'public:journal:article_citation_bib' journal_code=article.issue.journal.code issue_slug=article.issue.volume_slug issue_localid=article.issue.localidentifier localid=article.localidentifier %}" class="btn btn-primary cite-export">
        <span class="show cite-export-title">.BIB</span>
      </a>
      BibTeX, JabRef, Mendeley, Zotero
    </p>
  </div>
</div>
