{% extends "base.html" %}
{% load cache i18n static waffle_tags %}

{% block title %}{% trans "Cultivez votre savoir" %}{% endblock title %}

{% block structured_data %}
{{ block.super }}
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "WebSite",
  "name" : "Érudit",
  "url" : "{{ request.scheme }}://{{ request.site.domain }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ request.scheme }}://{{ request.site.domain }}{% url 'public:search:results' %}?basic_search_term={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item": {
      "@id": "{{ request.scheme }}://{{ request.site.domain }}",
      "name": "Érudit"
    }
  }]
}
</script>
{% endblock structured_data %}

{% block extrahead %}
<link rel="stylesheet" href="{% static 'css/videojs.css' %}" />
{% endblock extrahead %}

{% block body_id %}homepage{% endblock body_id %}
{% block data_controller %}public:home{% endblock data_controller %}

{% block content %}
{% trans "inconnu" as i18n_unknown %}
<main role="main">
  <h1 class="sr-only">{% trans "Accueil d’Érudit" %}</h1>
  {% cache LONG_TTL "public_home" LANGUAGE_CODE %}
  {# SEARCH #}
  <header class="home-header">
    <div class="container">
      <h2 class="home-header__title">{% trans "Érudit <br/>célèbre <br/>ses 20 ans&nbsp;!" %}</h2>
      <div class="row">
        <section class="col-sm-8 col-md-6 home-search">
          <h3 class="sr-only">{% trans "Effectuer une recherche simple" %}</h3>
          <form action="{% url 'public:search:results' %}" class="home-search__form" id="id-search" method="get">
            <label for="basic-search" class="home-search__label">{% trans "Recherche" %}</label>
            <div class="input-group">
              <input type="hidden" name="funds" value="Érudit">
              <input type="hidden" name="funds" value="UNB">
              <input name="basic_search_term" id="basic-search" type="search" class="home-search__input" placeholder="{% trans "Par auteur, titre, mots-clés&hellip;" %}" autofocus>
              <div class="home-search__addon">
                <button type="submit" class="home-search__btn">
                  <span class="sr-only">{% trans "Rechercher" %}</span>
                  <i class="icon ion-ios-search"></i>
                </button>
              </div>
            </div>
          </form>
          <div class="row">
            <div class="col-xs-6">
              <a href="#"><strong>--> {% trans "Vers les revues" %}</strong></a>
            </div>
            <div class="col-xs-6 text-right">
              <a href="{% url 'public:search:advanced_search' %}">{% trans "Recherche avancée" %}</a>
            </div>
          </div>
        </section>
      </div>
    </div>
  </header>

  {# LATEST ISSUES #}
  {% if latest_issues %}
  <section class="latest-issues">
    <div class="container">
      <h2>{% trans "Derniers numéros" %}</h2>
      <ul class="row">
        {% for issue in latest_issues %}
        <li class="col-xs-12 col-sm-6 col-md-3">
          {% if issue.has_coverpage %}
          <a href="{% url 'public:journal:issue_detail' issue.journal.code issue.volume_slug issue.localidentifier %}" title="{{ issue.journal.name }} - {% if issue.title %}{{ issue.title }}, {% endif %}{{ issue.volume_title }}">
            <img src="{% url 'public:journal:issue_coverpage' issue.journal.code issue.volume_slug issue.localidentifier %}" alt="{% blocktrans with journal_name=issue.journal.name issue_title=issue.title|default:issue.volume_title %}Couverture du numéro '{{ issue_title }}' de la revue '{{ journal_name }}'{% endblocktrans %}" class="img-responsive">
          </a>
          {% else %}
          <a href="{% url 'public:journal:issue_detail' issue.journal.code issue.volume_slug issue.localidentifier %}" title="{{ issue.journal.name }} - {% if issue.title %}{{ issue.title }}, {% endif %}{{ issue.volume_title }}">
            <img src="{% url 'public:journal:journal_logo' issue.journal.code %}" class="img-responsive" alt="{% blocktrans with journal_name=issue.journal.name %}Logo de la revue {{ journal_name }}{% endblocktrans %}"/>
          </a>
          {% endif %}
          <p>{{ issue.journal.disciplines.all|join:", " }} ({{ issue.journal.type|lower }})</p>
          <h3>
            <a href="{% url 'public:journal:journal_detail' issue.journal.code %}" title="{{ issue.journal.name }} - {% if issue.title %}{{ issue.title }}, {% endif %}{{ issue.volume_title }}">
              {{ issue.journal.name }}
            </a>
          </h3>
          <h4>
            <a href="{% url 'public:journal:issue_detail' issue.journal.code issue.volume_slug issue.localidentifier %}" title="{{ issue.journal.name }} - {% if issue.title %}{{ issue.title }}, {% endif %}{{ issue.volume_title }}">
              {% if issue.title %}<span class="issue-theme">{{ issue.title }}</span>{% endif %}
              {% if issue.volume_title %}<span class="issue-volume">{{ issue.volume_title }}</span>{% endif %}
            </a>
          </h4>
        </li>
        {% endfor %}
      </ul>
    </div>
  </section>
  {% endif %}

  {% switch "maintenance" %}
  {% else %}
  {# NEWS #}
  {% if latest_news %}
  <section class="news">
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <h2>{% trans "Nouvelles" %}</h2>
        </div>
      </div>
      <div class="row news--campaign">
        <div class="col-xs-12 col-md-8">
          <a href="http://partnership.erudit.org/{% if LANGUAGE_CODE == 'fr' %}accueil{% endif %}" target="_blank">
            <div id="campaign-banner" class="campaign-banner"></div>
          </a>
        </div>
        <div class="col-xs-12 col-md-4">
          <p class="category-tag">{% trans 'Libre accès' %}</p>
          <h3 class="news--campaign--title"><a href="http://partnership.erudit.org/{% if LANGUAGE_CODE == 'fr' %}accueil{% endif %}" target="_blank">{% trans 'Partenariat pour le libre accès' %}</a></h3>
          <p class="news--campaign--desc">{% blocktrans %}Le Partenariat pour le libre accès soutient depuis 2014 les revues canadiennes en SHS dans une transition graduelle vers le libre accès.{% endblocktrans %}</p>
          <p><a href="http://partnership.erudit.org/{% if LANGUAGE_CODE == 'fr' %}accueil{% endif %}" target="_blank">-> partnership.erudit.org</a></p>
        </div>
      </div>

      <ul class="row latest-news">
        {% for entry in latest_news %}
        <li class="col-md-4 col-sm-6 news--article">
          <p class="category-tag">{{ entry.category }}</p>
          <h3 class="news--article--title"><a href="{{ entry.link }}" target="_blank">{{ entry.title }}</a></h3>
          <p class="summary">{{ entry.summary|safe|truncatewords_html:20 }}&nbsp;<a href="{{ entry.link }}" target="_blank">{% trans "Lire la suite" %}</a></p>
          <time class="news--article--date text-muted" datetime="2001-05-15">{{ entry.dt_published|date:"DATE_FORMAT" }}</time>
        </li>
        {% endfor %}
      </ul>

      <div class="row">
        <div class="col-xs-12 text-center">
          <a href="{% if LANGUAGE_CODE == 'en' %}https://apropos.erudit.org/en/erudit-en/blog/{% else %}https://apropos.erudit.org/fr/erudit/blogue/{% endif %}" target="_blank" class="btn btn-secondary news--btn">{% trans "Toutes les nouvelles d'Érudit" %}</a>
        </div>
      </div>
    </div>
  </section>
  {% endif %}
  {% endswitch %}

  {# ABOUT ERUDIT.ORG #}
  <section class="container">
    <div class="row about-erudit">
      <div class="col-xs-12">
        <div class="row">
          <div class="col-sm-4 col-md-3"><h2 class="about-erudit--title">erudit.<br>org</h2></div>
          <div class="col-sm-4 col-md-3">
            <p class="about-erudit--description">{% trans "Érudit offre l'accès à de nombreuses collections de documents en sciences humaines et sociales&nbsp;: revues, livres et actes, thèses, rapports de recherche." %}<br /><br /><a href="http://apropos.erudit.org" target="_blank" class="text-muted">{% trans "En savoir plus" %}</a></p>
          </div>
          <div class="col-sm-4 col-md-6">
            <div class="about-erudit--video-container">
              <video
                id="about_erudit_video"
                class="video-js vjs-default-skin"
                controls
                preload="auto"
                width="1280"
                height="720"
                data-setup='{ "techOrder": ["vimeo"], "sources": [{ "type": "video/vimeo", "src": "{% if LANGUAGE_CODE == 'en' %}https://vimeo.com/106401822{% else %}https://vimeo.com/106409712{% endif %}"}] }'>
              </video>
            </div>
          </div>
        </div>

        <ul class="row about-users">
          <li class="col-sm-6 col-md-3 about-erudit--article">
            <h3 class="about-erudit--article--title">{% trans "Bibliothécaires" %}</h3>
            <p>{% blocktrans %}Offrez l’accès à du contenu savant et culturel de haut niveau à vos usagers.{% endblocktrans %}</p>
            <p><a href="https://apropos.erudit.org/fr/bibliotheques/" target="_blank" class="text-muted">{% trans "Abonnez-vous" %}</a></p>
          </li>
          <li class="col-sm-6 col-md-3 about-erudit--article">
            <h3 class="about-erudit--article--title">{% trans "Éditeurs" %}</h3>
            <p>{% blocktrans %}Diffusez votre revue en format numérique partout dans le monde.{% endblocktrans %}</p>
            <p><a href="https://apropos.erudit.org/fr/editeurs/" target="_blank" class="text-muted">{% trans "Publiez avec nous" %}</a></p>
          </li>
          <li class="col-sm-6 col-md-3 about-erudit--article">
            <h3 class="about-erudit--article--title">{% trans "Chercheurs" %}</h3>
            <p>{% blocktrans %}Accédez à des services adaptés à l’exploitation de corpus.{% endblocktrans %}</p>
            <p><a href="https://apropos.erudit.org/fr/chercheurs/" target="_blank" class="text-muted">{% trans "Explorez nos données" %}</a></p>
          </li>
          <li class="col-sm-6 col-md-3 about-erudit--article">
            <h3 class="about-erudit--article--title">{% trans "Utilisateurs" %}</h3>
            <p>{% blocktrans %}Trouvez les ressources et données pertinentes pour vos recherches.{% endblocktrans %}</p>
            <p><a href="https://apropos.erudit.org/fr/usagers/" target="_blank" class="text-muted">{% trans "Repérez des articles" %}</a></p>
          </li>
        </ul>
      </div>
    </div>
  </section>
</main>
{% endcache %}
{% endblock content %}

{% block footerscript %}
<script type="text/javascript" src="{% static 'js/videojs.js' %}"></script>
{% endblock footerscript %}
